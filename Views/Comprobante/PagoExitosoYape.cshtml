@model Marimon.Models.Comprobante
@{
    ViewData["Title"] = "Pago Exitoso";
}

@section Styles {
    <link rel="stylesheet" href="~/css/graciasYape.css" asp-append-version="true" />
}

<div class="container success-container">
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <div class="success-card">
                <div class="card-row">
                    <div class="image-column">
                        <div class="image-overlay"></div>
                        <img src="images\autoparte_gracias.jpg" alt="Marimon" class="autoparte-image">
                    </div>
                    <div class="content-column">
                        <h1 class="success-title">¡Gracias por tu compra!</h1>

                        <p class="success-description">
                            En breve, nuestro equipo comenzará a preparar tu pedido, seleccionando cuidadosamente la
                            autoparte para asegurarnos de que cumpla con los más altos estándares de calidad. Mientras
                            tanto, relájate y espera con confianza la llegada del componente que mantendrá tu vehículo
                            en óptimas condiciones.
                        </p>

                        <p class="success-description">
                            Gracias de nuevo por confiar en nosotros para satisfacer. Estamos
                            deseando que tengas una<span class="highlight-text">satisfacción tremenda</span>.
                        </p>

                        <div class="order-info">
                            <div class="order-row">
                                <span class="order-label">Número de pedido:</span>
                                <span class="order-value">#ORD-@(new Random().Next(10000, 99999))</span>
                            </div>
                            <div class="order-row">
                                <span class="order-label">Fecha:</span>
                                <span class="order-value">@DateTime.Now.ToString("dd MMMM, yyyy")</span>
                            </div>
                            <div class="order-row">
                                <span class="order-label">Estado:</span>
                                <span class="order-value" style="color: var(--primary-dark);">
                                    <i class="fas fa-check-circle"></i> Confirmado
                                </span>
                            </div>
                        </div>

                        <p class="success-description">
                            <strong>¡Disfruta de tu compra!</strong> Te notificaremos cuando tu pedido sea enviado.
                        </p>

                        <div class="d-flex justify-content-center">
                            <a asp-area="" asp-controller="Home" asp-action="Index" class="btn btn-primary-custom">
                                <i class="fas fa-store btn-icon"></i> Volver a la tienda
                            </a>
                        </div>

                        <div class="mt-3">
                            <span class="badge-custom">
                                <i class="fas fa-check-circle"></i> Envío Express
                            </span>
                            <span class="badge-custom">
                                <i class="fas fa-check-circle"></i> Calidad Garantizada
                            </span>
                            <span class="badge-custom">
                                <i class="fas fa-check-circle"></i> Especialistas en Autopartes
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function () {
            // Desactivar cualquier verificación automática del carrito
            window.onbeforeunload = null;

            // Desactivar cualquier temporizador existente
            var existingTimers = window.setTimeout(function () { }, 0);
            while (existingTimers--) {
                window.clearTimeout(existingTimers);
            }

            // Prevenir cualquier solicitud AJAX periódica
            $.ajaxSetup({
                beforeSend: function (xhr, settings) {
                    // Comprobar si la URL contiene 'Carrito' y cancelar esas solicitudes
                    if (settings.url && settings.url.includes('Carrito')) {
                        xhr.abort();
                        return false;
                    }
                }
            });

            // Efecto visual para mejorar la experiencia
            $(".success-card").hide().fadeIn(800);

            // Confetti para celebrar la compra exitosa
            setTimeout(function () {
                if (typeof confetti !== 'undefined') {
                    confetti({
                        particleCount: 100,
                        spread: 70,
                        origin: { y: 0.6 },
                        colors: ['#E42229', '#D42025', '#626C66']
                    });
                }
            }, 500);

            // Efecto hover para la imagen
            $(".image-column").hover(
                function () {
                    $(this).find(".autoparte-image").css("transform", "scale(1.05)");
                },
                function () {
                    $(this).find(".autoparte-image").css("transform", "scale(1)");
                }
            );
        });
    </script>
}